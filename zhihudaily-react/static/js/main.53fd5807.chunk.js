(window["webpackJsonpzhihudaily-react"]=window["webpackJsonpzhihudaily-react"]||[]).push([[0],{19:function(e,t,a){e.exports=a.p+"static/media/back.faae682f.svg"},24:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=Object(n.memo)((function(){return r.a.createElement("span",{className:"centre2",style:{fontSize:"1.5rem"}},"\u52a0\u8f7d\u4e2d",r.a.createElement("i",{className:"dot"}))}));t.a=s},43:function(e,t,a){e.exports=a.p+"static/media/comment.e25562b3.svg"},44:function(e,t,a){e.exports=a.p+"static/media/like.a9685f91.svg"},45:function(e,t,a){e.exports=a(92)},50:function(e,t,a){},85:function(e,t,a){},9:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),r=a.n(n).a.createContext({appState:{},appDispatch:function(){}})},91:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(16),c=a.n(s),o=(a(50),a(12)),l=a(17),i=a(10),u=a(7),p=a(18),m=a(37),d=a(38),f=a(22),E=a.n(f),S=a(34),y=a.n(S),O=(a(83),a(84),a(9));a(85);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}p.a.use(m.a),p.a.use(d.a);var g={fetchDate:"",topStories:[],listStories:[]};function h(e,t){switch(t.type){case"GET_TOP_STORIES":return D({},e,{topStories:t.payload});case"ADD_FIRST_LIST_STORIES":return D({},e,{listStories:[t.payload]});case"ADD_MORE_LIST_STORIES":var a=e.listStories.map((function(e){return e}));return a.push(t.payload),D({},e,{listStories:a});case"RESET_LIST_STORIES_DATA":return D({},e,{listStories:[]});case"SET_FETCH_DATE":return D({},e,{fetchDate:t.payload});case"LOAD_CACHE_DATA":return D({},e,{},t.payload);default:throw e}}var I,v,_=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],T=function(e){var t=new Date;return t.setFullYear(Number.parseInt(e.substr(0,4))),t.setMonth(Number.parseInt(e.substr(4,2))-1),t.setDate(Number.parseInt(e.substr(6,2))),t.getMonth()+1+"\u6708"+t.getDate()+"\u65e5 \u661f\u671f"+_[t.getDay()]},j=Object(n.memo)((function(){var e=Object(n.useRef)(""),t=Object(n.useState)(!1),a=Object(o.a)(t,2),s=(a[0],a[1]),c=Object(n.useReducer)(h,g),l=Object(o.a)(c,2),u=l[0],m=l[1];I=u;var d=Object(n.useContext)(O.a).appDispatch,f=Object(n.useMemo)((function(){return{dots:!0,infinite:!0,autoplay:!0,autoplaySpeed:3e3,arrows:!1}}),[]),S=Object(n.useMemo)((function(){return{click:!0,scrollY:!0,pullDownRefresh:{threshold:50,stop:0},pullUpLoad:{threshold:0},probeType:3}}),[]),b=Object(n.useCallback)((function(){d({type:"RESET_SLIDEIDS_ARR"}),E.a.get("https://zhihu-daily.leanapp.cn/api/v1/last-stories").then((function(t){if(s(!1),200===t.status){s(!1);var a=t.data.STORIES;m({type:"GET_TOP_STORIES",payload:a.top_stories}),m({type:"SET_FETCH_DATE",payload:a.date}),m({type:"ADD_FIRST_LIST_STORIES",payload:{data:a.stories,date:"\u4eca\u65e5\u70ed\u95fb"}}),e.current=a.date;var n=a.stories.map((function(e){return e.id}));d({type:"ADD_SLIDEIDS_ARR_ID",payload:n}),localStorage.setItem("storiesIds",JSON.stringify(n)),D(a.date)}})).catch((function(e){console.log(e),s(!1)}))}),[]),D=Object(n.useCallback)((function(t){E.a.get("https://zhihu-daily.leanapp.cn/api/v1/before-stories/"+t).then((function(t){if(s(!1),200===t.status){var a=t.data.STORIES;m({type:"SET_FETCH_DATE",payload:a.date}),m({type:"ADD_MORE_LIST_STORIES",payload:{data:a.stories,date:T(a.date)}}),e.current=a.date;var n=a.stories.map((function(e){return e.id}));d({type:"ADD_SLIDEIDS_ARR_ID",payload:n});var r=localStorage.getItem("storiesIds")||"[]";r=JSON.parse(r).concat(n),localStorage.setItem("storiesIds",JSON.stringify(n))}})).catch((function(e){console.log(e),s(!1)}))}),[]),_=Object(n.useCallback)((function(){s(!0),m({type:"RESET_LIST_STORIES_DATA"}),localStorage.setItem("storiesListCacheData",""),b()}),[]);return Object(n.useEffect)((function(){d({type:"SET_SIDEBAR_INFO",payload:{type:"list"}});var t=localStorage.getItem("storiesListCacheData");if(t){var a=JSON.parse(t);e.current=a.pageData.fetchDate,v=a.srollTop,m({type:"LOAD_CACHE_DATA",payload:a.pageData});var n=localStorage.getItem("storiesIds")||"[]";d({type:"ADD_SLIDEIDS_ARR_ID",payload:JSON.parse(n)})}else b()}),[]),Object(n.useLayoutEffect)((function(){var t=new p.a(".stories-list",S);if(t.on("pullingDown",(function(){_(),t.finishPullDown();var e=setTimeout((function(){t.refresh(),clearTimeout(e)}),500)})),t.on("pullingUp",(function(){D(e.current),t.finishPullUp();var a=setTimeout((function(){t.refresh(),clearTimeout(a)}),500)})),t.on("scrollEnd",(function(e){v=e.y})),v)var a=setTimeout((function(){clearTimeout(a),t.maxScrollY=v,t.scrollTo(0,v,0,{},!0)}),200);return function(){t.destroy(),localStorage.setItem("storiesListCacheData",JSON.stringify({pageData:I,srollTop:v}))}}),[]),r.a.createElement("div",{className:"stories-list fe ovys"},r.a.createElement("div",{style:{minHeight:"calc(100% + 1px)"}},r.a.createElement(y.a,Object.assign({},f,{className:"slider w100 ovh"}),u.topStories.map((function(e,t){return r.a.createElement(i.b,{className:"slide",key:t,to:"/article/slide/".concat(e.id)},r.a.createElement("img",{className:"slide-img",src:e.image,alt:""}),r.a.createElement("span",{className:"slide-text"},e.title))}))),u.listStories.map((function(e,t){return r.a.createElement("div",{className:"stories-section",key:t},r.a.createElement("div",{className:"head-title"},e.date),r.a.createElement("div",{className:"list"},e.data.map((function(e,t){return r.a.createElement(i.b,{className:"item",key:t,to:"/article/list/".concat(e.id)},r.a.createElement("span",{className:"text"},e.title),r.a.createElement("img",{src:e.images&&e.images[0],alt:""}))}))))}))))})),N=a(11),R=a(43),w=a.n(R),A=a(19),P=a.n(A),k=a(44),C=a.n(k),L=(a(91),Object(n.memo)((function(){var e=Object(n.useContext)(O.a),t=e.appState,a=e.appDispatch,s=Object(u.f)(),c=Object(n.useMemo)((function(){return t.sideBarInfo.type}),[t.sideBarInfo]),o=Object(n.useMemo)((function(){return t.sideBarInfo.data}),[t.sideBarInfo]);return r.a.createElement("div",{className:"page-sidebar"},"list"===c&&r.a.createElement("span",null,"\u9996\u9875"),"details"===c&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"left"},r.a.createElement(N.a,{className:"sidebar-svg",src:P.a,onClick:function(){s.go(-1)}})),r.a.createElement("div",{className:"right"},r.a.createElement("label",{className:"group",onClick:function(){a({type:"SET_SIDEBAR_INFO",payload:{type:"comment",data:o}}),s.push("/comment/"+o.detailsId)}},r.a.createElement(N.a,{className:"sidebar-svg message",src:w.a}),r.a.createElement("span",{className:"text"},o.comments)),r.a.createElement("label",{className:"group"},r.a.createElement(N.a,{className:"sidebar-svg",src:C.a}),r.a.createElement("span",{className:"text"},o.popularity)))),"comment"===c&&r.a.createElement("div",{className:"left"},o.detailsId?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{className:"sidebar-svg",src:P.a,onClick:function(){s.go(-1)}}),r.a.createElement("span",{className:"title"},o.comments,"\u6761\u8bc4\u8bba")):r.a.createElement(N.a,{className:"sidebar-svg",src:P.a,onClick:function(){s.push("/")}})))}))),x=Object(u.i)(L),F=a(24);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(a,!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=Object(n.lazy)((function(){return a.e(4).then(a.bind(null,97))})),z=Object(n.lazy)((function(){return a.e(3).then(a.bind(null,98))})),H=function(){return r.a.createElement(n.Suspense,{fallback:r.a.createElement(F.a,null)},r.a.createElement(J,null))},Y=function(){return r.a.createElement(n.Suspense,{fallback:r.a.createElement(F.a,null)},r.a.createElement(z,null))},U={detailsSlideIds:[],detailsFromType:"slide",sideBarInfo:{type:"list"}};function G(e,t){switch(t.type){case"ADD_SLIDEIDS_ARR_ID":var a=e.detailsSlideIds.concat(t.payload);return M({},e,{detailsSlideIds:a});case"RESET_SLIDEIDS_ARR":return M({},e,{detailsSlideIds:[]});case"SET_DETAILS_FROM_TYPE":return M({},e,{detailsFromType:t.payload});case"SET_SIDEBAR_INFO":return M({},e,{sideBarInfo:t.payload});default:throw e}}var W=function(){var e=Object(n.useReducer)(G,U),t=Object(o.a)(e,2),a=t[0],s=t[1];return r.a.createElement(O.a.Provider,{value:{appState:a,appDispatch:s}},r.a.createElement(i.a,null,r.a.createElement("div",{className:"App h5w wauto h100 grail"},r.a.createElement(x,null),r.a.createElement(u.c,null,r.a.createElement(u.a,{exact:!0,path:"//",component:j}),r.a.createElement(u.a,{path:"/article/:type/:id",component:H}),r.a.createElement(u.a,{path:"/comment/:id",component:Y})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[45,1,2]]]);
//# sourceMappingURL=main.53fd5807.chunk.js.map